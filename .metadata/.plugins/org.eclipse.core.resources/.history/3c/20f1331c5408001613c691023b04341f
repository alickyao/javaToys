package toysIo;

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.io.InputStreamReader;

public class TestIo {
	private final static String path = "files/";
	public static void main(String[] agrs){
		
		try {
			//readfile1();//直接读
			//write1();//直接写
			//write2();//缓冲区写
			//read2();//缓冲区读取
			//write3();//末尾追加
			//test1();//测试 阻塞  等待系统输入  br.readln();
			data1();//数据流
		} catch (FileNotFoundException e) {
			// TODO Auto-generated catch block
			System.out.println("文件未找到");
		} catch (IOException e) {
			// TODO Auto-generated catch block
			System.out.println("文件读写错误");
		}
	}
	
	//FileInputStream
	public  static void  readfile1() throws IOException,FileNotFoundException {
			FileInputStream fileInputStream = new FileInputStream(new File("src/toysIo/TestIo.java"));
			int c;
			while ((c = fileInputStream.read()) != -1) {
				System.out.print((char)c);
			}
			fileInputStream.close();
	}
	
	//FileWrite
	public static void  write1() throws IOException,FileNotFoundException {
		File pFile = new File(path);
		if (!pFile.exists()){
			pFile.mkdirs();
		}
		FileWriter fileWriter = new FileWriter(new File(path+"test.txt"));
		for(int i=0;i<50;i++){
			fileWriter.write(String.valueOf(i)+" ");
		}
		fileWriter.close();
	}
	
	//用缓冲写
	public  static void write2() throws IOException,FileNotFoundException {
		FileWriter fileWriter = new FileWriter(new File(path+"test.txt"));
		BufferedWriter bufferedWriter =  new BufferedWriter(fileWriter);
		for(int i=0;i<50;i++){
			bufferedWriter.write(String.valueOf(i));
			bufferedWriter.newLine();
		}
		bufferedWriter.flush();
		bufferedWriter.close();
	}
	
	//用缓冲读取
	public static void read2() throws IOException,FileNotFoundException {
		FileReader fileReader = new FileReader(new File(path+"test.txt"));
		BufferedReader bufferedReader = new BufferedReader(fileReader);
		String lString;
		while ((lString = bufferedReader.readLine())!= null) {
			System.out.println(lString);
		}
	}
	
	//在文件末尾追加一行
	public  static void  write3() throws IOException,FileNotFoundException {
		write2();
		File file = new File(path+"test.txt");
		//写入  
		FileWriter fileWriter = new FileWriter(file,true);//true表示追加
		BufferedWriter bufferedWriter = new BufferedWriter(fileWriter);
		bufferedWriter.newLine();
		bufferedWriter.write("新的一行");
		bufferedWriter.flush();
		bufferedWriter.close();
		
	}
	
	//System.in
	public static void test1() throws IOException,FileNotFoundException {
		InputStreamReader in = new InputStreamReader(System.in);
		BufferedReader b = new BufferedReader(in);
		String s = b.readLine();
		while (s!=null) {
			if (s.equalsIgnoreCase("exit")){break;}
			System.out.println(s.toUpperCase());
			s = b.readLine();
		}
		System.exit(0);//-1表示非正常退出
	}
	
	//数据管道
	public static void data1() throws IOException,FileNotFoundException  {
		
		
		ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();
		DataOutputStream dataOutputStream = new DataOutputStream(byteArrayOutputStream);
		
		//队列，先进先出的原则
		dataOutputStream.writeUTF("helloword");
		dataOutputStream.writeInt(1);
		
		//将字节输出流 改为转换为字节数组
		ByteArrayInputStream byteArrayInputStream = 
				new ByteArrayInputStream(byteArrayOutputStream.toByteArray());
		
		DataInputStream dataInputStream = new DataInputStream(byteArrayInputStream);
		System.out.println(dataInputStream.readUTF());
		System.out.println(dataInputStream.readInt());
		
		//如何写到文件中呢?
		DataOutputStream dataOutputStream2 = new DataOutputStream(new FileOutputStream(new File(path+"data.dat")));
		dataOutputStream2.writeLong(123213l);
		dataOutputStream2.flush();
		dataOutputStream2.close();
	}
}
